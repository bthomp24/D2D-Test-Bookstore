{% extends "base_sidebar.html" %}

{% block content %}

<div id="columnMiddleResult" class="column middle" style="background-color:white;">
    <h2>Results Found In:</h2>
    {% for site in site_list %}
        <h3 class="site-name">{{ site.name }}:</h3>
        {% if site.books|length > 1 %}
            {% for book in site.books %}
                {% if forloop.first %}
                    <a href="{{ book.link }}" target="_blank" class="book-link">
                        <div class="flex-content">
                        {% if book.cover == None or book.cover|length < 1 %}
                            <img src="http://www.lse.ac.uk/International-History/Images/Books/NoBookCover.png">
                        {% else %}
                            <img src="{{ book.cover }}">
                        {% endif %}
                            <div class="flex-child-first">
                                <p class="flex-child-first-child" title="{{ book.name }}">{{ book.name|truncatechars:70 }}</p>
                                <p class="flex-child-first-child" title="{{ book.author }}">By: {{ book.author|truncatechars:67 }}</p>
                            </div>
                            <p class="flex-child-last">Rating: {{ book.rating }}%</p>
                        </div>
                    </a>

                    <button class="accordion">More Results</button>
                    <div class="panel">
                {% elif forloop.last %}
                        <a href="{{ book.link }}" target="_blank" class="book-link">
                            <div class="flex-content">
                            {% if book.cover == None or book.cover|length < 1 %}
                                <img src="http://www.lse.ac.uk/International-History/Images/Books/NoBookCover.png">
                            {% else %}
                                <img src="{{ book.cover }}">
                            {% endif %}
                                <div class="flex-child-first">
                                    <p class="flex-child-first-child" title="{{ book.name }}">{{ book.name|truncatechars:40 }}</p>
                                    <p class="flex-child-first-child" title="{{ book.author }}">By: {{ book.author|truncatechars:37 }}</p>
                                </div>
                                <p class="flex-child-last">Rating: {{ book.rating }}%</p>
                            </div>
                        </a>
                    </div>
                {% else %}
                        <a href="{{ book.link }}" target="_blank" class="book-link">
                            <div class="flex-content">
                            {% if book.cover == None or book.cover|length < 1 %}
                                <img src="http://www.lse.ac.uk/International-History/Images/Books/NoBookCover.png">
                            {% else %}
                                <img src="{{ book.cover }}">
                            {% endif %}
                                <div class="flex-child-first">
                                    <p class="flex-child-first-child" title="{{ book.name }}">{{ book.name|truncatechars:40 }}</p>
                                    <p class="flex-child-first-child" title="{{ book.author }}">By: {{ book.author|truncatechars:37 }}</p>
                                </div>
                                <p class="flex-child-last">Rating: {{ book.rating }}%</p>
                            </div>
                        </a>
                {% endif %}
            {% endfor %}
        {% elif site.books|length == 1 %}
            {% for book in site.books %}
                <a href="{{ book.link }}" target="_blank" class="book-link">
                    <div class="flex-content">
                    {% if book.cover == None or book.cover|length < 1 %}
                        <img src="http://www.lse.ac.uk/International-History/Images/Books/NoBookCover.png">
                    {% else %}
                        <img src="{{ book.cover }}">
                    {% endif %}
                        <div class="flex-child-first">
                            <p class="flex-child-first-child" title="{{ book.name }}">{{ book.name|truncatechars:70 }}</p>
                            <p class="flex-child-first-child" title="{{ book.author }}">By: {{ book.author|truncatechars:67 }}</p>
                        </div>
                        <p class="flex-child-last">Rating: {{ book.rating }}%</p>
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <p class="empty-results">No Results Found</p>
        {% endif %}
    {% endfor %}
</div>

{% endblock %}